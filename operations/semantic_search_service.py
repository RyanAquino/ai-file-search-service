

class SemanticSearchService:

    def __init__(self, settings, pinecone_index, embedding_client):
        self.settings = settings
        self.pinecone_index = pinecone_index
        self.embedding_client = embedding_client

    def search(self, search_term, file_id):
        # term_embedding = self.embedding_client.embed_query(search_term)
        term_embedding = [0.009101836010813713, -0.002777066547423601, -0.003936491906642914, -0.00982387363910675, 0.009775274433195591, 0.0022737232502549887, -0.023896658793091774, -0.010059923864901066, 0.011858074925839901, -0.0185091495513916, -0.003372400300577283, 0.004519675858318806, -0.010441770777106285, -0.011142980307340622, -0.027909519150853157, 0.0062726992182433605, 0.011365145444869995, -0.014676797203719616, 0.01202469877898693, -0.00517228664830327, -0.0034834828693419695, 0.008414511568844318, -0.001303485594689846, -0.023716149851679802, -0.007782729342579842, 0.0002731505373958498, 0.011337374337017536, -0.030325567349791527, -0.00445024948567152, 0.0014067578595131636, 0.02642378956079483, -0.023646721616387367, -0.021855514496564865, 0.008671390824019909, 0.004700185265392065, 0.010608394630253315, -0.022910799831151962, 0.021036280319094658, 0.030325567349791527, -0.013489601202309132, 0.021383412182331085, -0.015135013498365879, 0.0172455832362175, -0.00022368403733707964, 0.0034522409550845623, -0.00442942138761282, 0.018578575924038887, 0.008025722578167915, -0.023174621164798737, -0.007213430479168892, 0.007643876131623983, 0.018634116277098656, -0.01662074401974678, 0.003801109967753291, 0.0012383981375023723, 0.008608906529843807, -0.02681257762014866, 0.014982274733483791, -0.007824385538697243, -0.04479408636689186, -0.008338142186403275, 0.012767563574016094, -0.04773777723312378, 0.013753422535955906, -0.030603274703025818, 0.002745824633166194, -0.012830047868192196, -0.0033637220039963722, -0.01567654125392437, -0.0019335326505824924, 0.03626849129796028, 0.03515766188502312, 0.03207511827349663, 0.015357178635895252, 0.04390542209148407, -0.008851899765431881, 0.01143457181751728, -0.017273355275392532, -0.012031640857458115, -0.011545654386281967, -0.0020133734215050936, -0.0021747902501374483, -0.00973361823707819, 0.008601963520050049, -0.00012117122969357297, 0.006210215389728546, -0.008018779568374157, 0.015829280018806458, 0.013357690535485744, -0.0018293926259502769, -0.0034713333006948233, 0.006550406105816364, 0.02557678334414959, 0.01364233996719122, -0.02155003696680069, 0.004311395809054375, 0.02486863173544407, 0.013461830094456673, 0.0056860437616705894, -0.011198521591722965, 0.013607626780867577, -0.005498591810464859, -0.025660095736384392, -0.0016167734283953905, -0.010761133395135403, -0.018078703433275223, 0.018550805747509003, -0.008601963520050049, 0.024174364283680916, -0.010587566532194614, -0.024840861558914185, 0.03671282157301903, 0.0025722580030560493, -0.014954503625631332, 0.000866531569045037, -0.022188762202858925, 0.023938314989209175, -0.01818978600203991, -0.011323489248752594, 0.01909233257174492, 0.024493727833032608, 0.006175501737743616, 0.02239704318344593, -0.0007732394733466208, 0.011823360808193684, -0.00034821813460439444, -0.02822888270020485, 0.0009372599888592958, -0.008046550676226616, -0.008595021441578865, 0.0236744936555624, -0.0047140708193182945, 0.02709028497338295, 0.027312450110912323, -0.013933931477367878, 0.012128838337957859, 0.0067725712433457375, 0.02093908190727234, -0.030769897624850273, -0.02836773544549942, 0.018592461943626404, 0.01628749631345272, -0.03257499262690544, -0.010143236257135868, 0.013954759575426579, -0.001841542311012745, -0.006491393316537142, -0.0008786812541075051, 0.006845469120889902, -0.013559027574956417, 0.0147045673802495, -0.003988562151789665, 0.026451559737324715, 0.024035511538386345, 0.005134101957082748, 0.016468005254864693, -0.012156609445810318, 0.027631813660264015, -0.013003614731132984, -0.0037837533745914698, 0.009053236804902554, 0.008324257098138332, 0.005547190550714731, -0.013128582388162613, 0.01030291710048914, -0.0007879926706664264, -0.009462854824960232, 0.01167062297463417, 0.00736616924405098, -0.008053493686020374, 0.013322977349162102, -0.001992545323446393, -0.016842909157276154, 0.008275658823549747, 0.0013277849648147821, 0.04171153903007507, 0.0020775930024683475, 0.0235911812633276, -0.0041343579068779945, -0.009643363766372204, -0.041406065225601196, -0.007505022455006838, 0.010400114580988884, 0.020855769515037537, -0.01942558027803898, 0.00440512178465724, 0.0067343865521252155, 0.013079984113574028, -0.0061824447475373745, -0.012344061397016048, 0.005991521291434765, 0.016926221549510956, 2.4055254471022636e-05, -0.003915663808584213, -0.604289710521698, -0.01809258945286274, -0.005252127069979906, -0.02068914659321308, 0.015412719920277596, 0.023841116577386856, 0.032269515097141266, -0.00023496587527915835, -0.003700441215187311, -0.04682134464383125, -0.016981761902570724, 0.012163551524281502, 0.010781961493194103, -0.012496800161898136, -0.006737858057022095, -0.014072785153985023, -0.0018293926259502769, -0.010115465149283409, 0.008407569490373135, 0.00014883340918458998, 0.00020632737141568214, 0.020994624122977257, -0.03915663808584213, 0.0050056627951562405, 0.018786855041980743, -0.00904629472643137, -0.012948073446750641, -0.020675260573625565, 0.0028742640279233456, 0.00971279013901949, -0.021911054849624634, 0.034269001334905624, -0.0059741646982729435, 0.0008912648190744221, 0.05518031492829323, 0.008581136353313923, -0.02689589001238346, 0.03574084863066673, 0.005446522030979395, 0.035546451807022095, -0.0015091621316969395, -0.013295206241309643, 0.012830047868192196, -0.00092337466776371, 0.0013737801928073168, -0.006977379787713289, 0.03107537515461445, -0.019828256219625473, 0.014343549497425556, -0.005127159412950277, 0.0006048798095434904, -0.015037816017866135, -0.00847699586302042, 0.012448200955986977, 0.014468517154455185, -0.010545910336077213, 0.029520219191908836, -0.03174187242984772, 0.002365713706240058, 0.0068975393660366535, 0.021189019083976746, -0.002966254251077771, -0.012455143965780735, -0.04201701655983925, -0.01453794352710247, 0.0010275146923959255, -0.006130374502390623, 0.002721525263041258, 0.017106730490922928, -0.013420174829661846, -0.00862279161810875, -0.016745712608098984, 0.000828346936032176, -0.005123687908053398, 0.029853466898202896, 0.008400626480579376, 0.01573208160698414, -0.027867862954735756, 0.012732850387692451, 0.006574705243110657, -0.01271896529942751, 0.0001363583141937852, -0.0017443449469283223, -0.006220629438757896, -0.01473233848810196, -0.023007996380329132, -0.03551868349313736, -0.005887381266802549, 0.0276179276406765, -0.00064523407490924, 0.023785576224327087, -0.007130118552595377, 0.031103147193789482, -0.020661376416683197, -0.02699308842420578, 0.021730545908212662, -0.005568018648773432, -0.016773482784628868, 0.001803357619792223, -0.021619463339447975, -0.024354875087738037, 0.0008973396616056561, -0.007692474406212568, -0.00828954391181469, 0.018217558041214943, -0.003762925276532769, -0.010330688208341599, -0.0006834187661297619, 0.0356297641992569, -0.014274122193455696, 0.006553877145051956, 0.0024004268925637007, -0.011351259425282478, 0.006168559193611145, 0.002586143324151635, -0.03349142521619797, 0.002518452238291502, -0.009580879472196102, -0.00797712430357933, 0.017301125451922417, 0.01671794056892395, 0.00013332089292816818, 0.03049219213426113, 0.01366316806524992, -0.0019560963846743107, 0.03476887568831444, -0.0064011383801698685, -0.006047062575817108, 0.01917564496397972, 0.004689771216362715, -0.017453864216804504, 0.0053389105014503, 0.033658046275377274, -0.017301125451922417, 0.03479664400219917, 0.018314754590392113, -0.013920046389102936, -0.028770409524440765, 0.0065642911940813065, -0.023785576224327087, -0.034269001334905624, -0.007595277391374111, 0.01255234144628048, -0.04310007393360138, -0.03204734995961189, -0.022327614948153496, -0.010788903571665287, 0.023632837459445, -0.006383781787008047, 0.030186714604496956, -0.01368399616330862, 0.00018365522555541247, -0.03557422384619713, 0.013017499819397926, -0.014426860958337784, 0.006599004380404949, 0.024521498009562492, -0.04268351569771767, 0.013815906830132008, 0.008581136353313923, 0.005397923290729523, -0.012239920906722546, -0.021772202104330063, -0.008553365245461464, -0.02098073810338974, -0.015232210047543049, -0.001853691996075213, 0.0018085646443068981, -0.01164979487657547, -0.03893447294831276, 0.0005983710871078074, 0.010629222728312016, -0.0014952768106013536, 0.017065074294805527, -0.012226035818457603, -0.019314497709274292, -0.010073808953166008, -0.007761901244521141, 0.012538455426692963, -0.017925964668393135, 0.022980226203799248, 0.0025340733118355274, -0.019120104610919952, 0.0012913360260426998, 0.008449225686490536, 0.03168633207678795, -0.005613145884126425, -0.00735228369012475, -0.006342126056551933, -0.005595789290964603, -0.00904629472643137, 0.012267692014575005, 0.01494061853736639, 0.01600978896021843, 0.037351544946432114, 0.0027163182385265827, 0.011566482484340668, 0.0051410445012152195, 0.008372856304049492, 0.01571819745004177, 0.035296518355607986, 0.002834343584254384, 0.010393171571195126, -0.0028412863612174988, 0.022313730791211128, -0.0028187227435410023, 0.0051757581532001495, -0.0008556836401112378, 0.009164320304989815, 0.004165600053966045, -0.005960279144346714, -0.020911311730742455, -0.017120616510510445, -0.00031849482911638916, 0.016023674979805946, 0.009573937393724918, 0.009830815717577934, 0.022174876183271408, -0.006345597095787525, -0.00021424634905997664, 0.01785653829574585, 0.003266524523496628, 0.020328128710389137, -0.0006022763554938138, -0.025826720520853996, -0.006231043487787247, -0.011163807474076748, 0.022230418398976326, 0.019814370200037956, -0.0037039127200841904, -0.025701751932501793, -0.02155003696680069, -0.010094637051224709, 0.0030599802266806364, 0.009580879472196102, -0.0022042966447770596, 0.012448200955986977, -0.03599078208208084, 0.0003341158153489232, 0.03288047015666962, 0.03726823255419731, 0.0023952198680490255, -0.01852303370833397, -0.01785653829574585, 0.041794851422309875, 0.006067890673875809, 0.05715203285217285, 0.032519448548555374, -0.012489857152104378, 0.016079215332865715, 0.01752329058945179, 0.0010743776801973581, -0.013531257398426533, 0.018592461943626404, 0.011733106337487698, 0.0009554845164529979, 0.02302188239991665, 0.018175901845097542, -1.962116948561743e-05, 0.018856283277273178, 0.015898706391453743, -0.017301125451922417, 0.028548244386911392, 0.03499104082584381, 0.008109034970402718, -0.013565970584750175, -0.005901266820728779, -0.03760148212313652, -0.0002764049277175218, -0.009428141638636589, 0.015496031381189823, 0.0002857341314665973, 0.01662074401974678, -0.006939195096492767, 0.003302973695099354, -0.01544049009680748, 0.004311395809054375, 0.025743408128619194, 0.02614608220756054, -0.0020342012867331505, -0.014343549497425556, -0.01250374224036932, -0.007470309268683195, 0.011045782826840878, 0.0023205862380564213, -0.007157889194786549, -0.024590924382209778, -0.016870679333806038, -0.0011941386619582772, 0.00515145855024457, -0.01082361675798893, -0.0265626423060894, -0.023091308772563934, -0.02665983885526657, -0.003013117238879204, -0.016773482784628868, 0.014357434585690498, -0.012281577102839947, -0.055430248379707336, -0.005804069340229034, -0.0023639779537916183, -0.02093908190727234, 0.02496582828462124, -0.05440273508429527, 0.016981761902570724, -0.0006170294946059585, -0.03463001921772957, 0.006415023934096098, -0.00147965585347265, -0.01907844841480255, -0.018495263531804085, 0.003145027905702591, 0.007095405366271734, 0.005779769737273455, -0.009442026726901531, 0.013697881251573563, 0.0005632238462567329, -0.01141374371945858, 0.034019067883491516, -0.02017538994550705, 0.012712022289633751, -0.0036171292886137962, -0.014787879772484303, 0.01803704723715782, 0.026493215933442116, -0.0027926876209676266, 0.03324148803949356, 0.018120359629392624, -0.009122664108872414, 0.016037559136748314, -0.02400774136185646, -0.007539736106991768, 0.009865528903901577, -0.005758942104876041, 0.017217813059687614, 0.007817442528903484, 0.01805093325674534, -0.00812292005866766, 0.0032179260160773993, 0.011177693493664265, 0.007560563739389181, -0.029575759544968605, 0.015690427273511887, -0.00039942029980011284, -0.024993600323796272, 0.0018693129532039165, 0.041517145931720734, 0.03590747341513634, -0.01051119714975357, -0.015093357302248478, 0.005627031438052654, 0.004776554647833109, 0.012184379622340202, 0.000638725352473557, 0.0202170442789793, 0.014274122193455696, 0.003016588743776083, 0.008525594137609005, -0.018717428669333458, -0.013225779868662357, 0.005189643241465092, 0.0007311495719477534, 0.01624584011733532, 0.017787111923098564, 0.035018809139728546, 0.014662912115454674, 0.014885077252984047, -0.0031172572635114193, 0.017162272706627846, -0.009719733148813248, -0.012698137201368809, 0.007643876131623983, -0.0066892593167722225, -0.014690682291984558, 0.02207767963409424, -0.0017469484591856599, -0.025660095736384392, -0.005571490153670311, 0.0072412011213600636, -0.007838270626962185, -0.009928013198077679, -0.0019838670268654823, 0.01581539399921894, -0.025021370500326157, -0.01382979191839695, -0.0414893738925457, 0.016093101352453232, -0.012628710828721523, -0.03082543984055519, -0.011545654386281967, -0.0213556420058012, -0.01217049453407526, -0.03015894442796707, -0.001093470025807619, 0.015357178635895252, -0.00551941990852356, -0.03101983480155468, -0.008976868353784084, 0.002994024893268943, 0.004776554647833109, 0.02547958679497242, -0.01049036905169487, -0.009081007912755013, 0.041045043617486954, -0.007407825440168381, -0.00440512178465724, -0.02624328061938286, -0.023660607635974884, -0.0195644348859787, 0.034491166472435, -0.007921583019196987, -0.0092129185795784, 0.00497094914317131, 0.013059156015515327, -0.0024212549906224012, 0.009129606187343597, 0.04646032303571701, 0.0013841941254213452, 0.004578688647598028, -0.006411552429199219, 0.0038323518820106983, 0.02225818857550621, -0.0006005406612530351, -0.027020858600735664, -0.006703144405037165, -0.020994624122977257, -0.024229906499385834, -0.017703799530863762, 0.006533049046993256, 0.0036657280288636684, 0.0019387396750971675, 0.0034088492393493652, 0.0017860010266304016, -0.013170238584280014, 0.020716916769742966, -0.038906704634428024, 0.01860634610056877, 0.005109802819788456, -0.004012861289083958, 0.02809002995491028, 0.0014327928656712174, 0.008414511568844318, -0.011087438091635704, 0.008220117539167404, 0.012941130436956882, -0.013184123672544956, 0.023327359929680824, 0.034269001334905624, -0.009976611472666264, 0.02098073810338974, -0.016093101352453232, -0.0014787879772484303, -0.005168815143406391, -0.010379286482930183, -0.014114441350102425, 0.04137829318642616, 0.01534329354763031, -0.02461869642138481, -0.03443562611937523, -0.03618517890572548, 0.0058561391197144985, -0.004620344843715429, -0.01013629324734211, -0.016690170392394066, -0.017745455726981163, -0.006751743145287037, 0.0029436906334012747, -0.008400626480579376, 0.012246863916516304, -0.017731569707393646, -0.006966965738683939, -0.013392403721809387, -0.007206487935036421, 0.00021793464838992804, -0.020439211279153824, 0.014746223576366901, -0.006578176748007536, 0.01591259241104126, -0.024216020479798317, -0.04868197813630104, -0.010886101052165031, -0.01742609404027462, 0.01015712134540081, -0.0027041686698794365, 0.0027562386821955442, 0.007178717292845249, -0.00027488620253279805, 0.009691962972283363, 0.015190554782748222, -0.007748015690594912, -0.014649026095867157, 0.014246352016925812, -0.03624071925878525, -0.0010986769339069724, 0.02414659410715103, 0.00814374815672636, -0.004120472818613052, -0.016356922686100006, -0.0045439754612743855, 0.0368516743183136, -0.016801252961158752, 2.939785372291226e-05, 0.0045509180054068565, -0.045627206563949585, 0.0005992389051243663, -0.0033671932760626078, 0.00368308462202549, -0.004925821907818317, -0.011830303817987442, -0.010990241542458534, 0.02206379361450672, -0.012746735475957394, 0.020397555083036423, -0.006460151169449091, 0.006206743884831667, -0.04812656342983246, 0.009247631765902042, -0.02907588705420494, 0.02575729228556156, -0.0013651017798110843, 0.009087950922548771, -0.007616105023771524, -0.005064675118774176, 0.014912847429513931, 0.006172030698508024, 0.011573425494134426, -2.5546843971824273e-05, -0.0053041973151266575, 0.006696201860904694, 0.007227316033095121, -0.023480098694562912, -0.007671646773815155, -0.0018901409348472953, -0.013940874487161636, -0.020494751632213593, -0.007595277391374111, -0.01259399764239788, -0.0276595838367939, 0.02334124594926834, 0.01219132263213396, 0.004464134573936462, 0.027409648522734642, -0.010830559767782688, 0.009747504256665707, 0.0277012400329113, 0.008435339666903019, 0.034491166472435, -0.014149154536426067, 0.007643876131623983, -0.00679687038064003, -0.0028690570034086704, -0.02803448773920536, -0.06531661003828049, -0.007470309268683195, -0.005248656030744314, 0.010233490727841854, 0.03324148803949356, -0.0015082943718880415, 0.003915663808584213, 0.00994884129613638, 0.047765545547008514, -0.011469285003840923, -0.03471333160996437, 0.033741358667612076, 0.024257676675915718, 0.013052213005721569, 0.0022372743114829063, -0.012642595916986465, -0.0013008821988478303, -0.0007007754174992442, 0.011385973542928696, -0.03557422384619713, -0.026979202404618263, -0.009934956207871437, 0.015759853646159172, -0.009469796903431416, -0.025410160422325134, 0.007171774748712778, 0.016148641705513, -0.01738443784415722, 0.03304709121584892, -0.0161902979016304, -0.010906929150223732, 0.024826975539326668, -0.002405633917078376, 0.03204734995961189, 0.008470052853226662, -0.011385973542928696, 0.010233490727841854, 0.021605579182505608, -0.003329008584842086, -0.004491905216127634, -0.01534329354763031, 0.04532172903418541, -0.0023830702994018793, -0.008254830725491047, 0.003212718991562724, 0.01351737231016159, 0.0224942397326231, -0.004991777241230011, 0.0073592266999185085, 0.003655313979834318, -0.03190849721431732, -0.013697881251573563, -0.007380054797977209, 0.003808052511885762, -0.01563488505780697, -0.022480353713035583, -0.00918514747172594, -0.013732594437897205, 0.02306353859603405, -0.006387253291904926, 0.013892276212573051, -0.010358458384871483, -0.039517659693956375, -0.011045782826840878, -0.04465522989630699, 0.016981761902570724, 0.0012731114402413368, -0.0031328783370554447, -0.003808052511885762, 0.030297797173261642, -0.049987200647592545, 0.013628454878926277, 0.02368837781250477, -0.0045960452407598495, -0.003700441215187311, -0.003384549869224429, -0.005411808378994465, -0.014156097546219826, 0.018550805747509003, -0.007289799861609936, -0.011906673200428486, -0.03954542800784111, 0.02614608220756054, 0.01307304110378027, -0.0013121640076860785, 0.022147106006741524, 0.021425068378448486, -0.0034956326708197594, -0.0011819889768958092, 0.01742609404027462, -0.031797412782907486, 0.005679101217538118, 0.020897425711154938, 0.008990753442049026, 0.018856283277273178, -0.012538455426692963, 0.03979536518454552, 0.004575217142701149, 0.002872528275474906, -0.004460663069039583, -0.04176708310842514, -0.029909007251262665, 0.026840349659323692, 0.025840604677796364, -0.03874007984995842, -0.0471823625266552, -0.022369271144270897, -0.009261516854166985, -0.02074468694627285, 0.0034053779672831297, -0.0043426379561424255, 0.011323489248752594, 0.040656257420778275, -0.013357690535485744, -0.009809987619519234, 0.0172455832362175, -0.009532281197607517, 0.009955784305930138, 0.00980304554104805, -0.010191834531724453, -0.011024954728782177, -0.017731569707393646, -0.018953479826450348, 0.030242254957556725, 0.0034314128570258617, 0.0005779769853688776, -0.013371575623750687, 0.006293527316302061, -0.061262089759111404, 0.0022355385590344667, -0.007373111788183451, 0.018411951139569283, 0.017773225903511047, 0.0029193912632763386, 0.009525338187813759, 0.00793546810746193, -0.02229984477162361, 0.0005866553401574492, -0.017273355275392532, -0.0019908095709979534, -0.011073553003370762, -0.036685049533843994, 0.0010448712855577469, -0.004318338818848133, -0.007262029219418764, -0.02463258057832718, 0.028909264132380486, -0.0007472044671885669, -0.0016783896135166287, 0.01742609404027462, 0.0069808512926101685, 0.01642634905874729, 0.003978148102760315, -0.005203528795391321, -0.004474548622965813, 0.013815906830132008, 0.010351516306400299, -0.024132709950208664, 0.007074577268213034, 0.011177693493664265, -0.022327614948153496, 0.0006348200840875506, 0.004283625166863203, 0.009240689687430859, -0.005904737859964371, 0.008115977048873901, 0.00978221744298935, -0.014801764860749245, 0.006491393316537142, -0.010420942679047585, 0.02609054185450077, -0.022563666105270386, 0.004300981760025024, 0.017217813059687614, -0.016690170392394066, -0.010719477199018002, -0.0014622991438955069, 0.007012093439698219, -0.04010084271430969, -0.0021088349167257547, -0.013038327917456627, -0.02211933583021164, 0.026493215933442116, -0.004446777980774641, 0.0185091495513916, -0.00786604080349207, 0.0173288956284523, 0.022285960614681244, -0.0033932283986359835, -0.004096173215657473, 0.018148129805922508, 0.026604298502206802, -0.0010153650073334575, 0.003790695918723941, 0.0038566512521356344, -0.014385204762220383, -0.004922350402921438, -0.014079728163778782, 0.0022129749413579702, -0.023702263832092285, 0.022577552124857903, 0.005935980007052422, -0.01311469729989767, -0.00050594680942595, -0.008983810432255268, 0.0010144971311092377, -0.007053749170154333, -0.006946138106286526, 0.29925671219825745, -0.005439579486846924, -0.00047557265497744083, 0.029381364583969116, -0.0202170442789793, -0.007123176008462906, 0.02604888565838337, 0.025326848030090332, 0.003290823893621564, 0.02520187944173813, -0.012677309103310108, -0.0044710771180689335, 0.006970437243580818, 0.0045891026966273785, 0.012142723426222801, -0.032658305019140244, -0.02799283154308796, -0.021008508279919624, -0.02325793355703354, 0.023507868871092796, 0.036212947219610214, 0.006001935340464115, -0.0030460949055850506, -0.009386485442519188, 0.017176156863570213, 0.02141118422150612, -0.01662074401974678, 0.008400626480579376, 0.015051701106131077, 0.027201367542147636, -0.006904481910169125, -0.009553109295666218, -0.0007189998868852854, -0.014218580909073353, -0.010420942679047585, -0.0036657280288636684, 0.03851791471242905, 0.007810499984771013, 0.009608650580048561, 0.01856468990445137, -0.011024954728782177, -0.011885845102369785, -0.003884421894326806, -0.009643363766372204, -0.005946394056081772, -0.00590820936486125, -0.0018831982742995024, -0.02084188535809517, 0.005620088428258896, 0.03954542800784111, -0.03721269220113754, -0.014690682291984558, 0.015259981155395508, 0.02064749039709568, 0.016315266489982605, 0.013871448114514351, 0.016301380470395088, 0.0008817186462692916, 0.014412975870072842, -0.0015863992739468813, 0.0020342012867331505, 0.022424813359975815, -0.03632403165102005, 0.017773225903511047, -0.036351803690195084, -0.0172872394323349, -0.02860378660261631, -0.018870167434215546, 0.003762925276532769, -0.011281833052635193, 0.01070559211075306, 0.00440512178465724, -0.029103659093379974, 0.010087694972753525, -0.017078960314393044, -0.039517659693956375, 0.037629254162311554, 0.014676797203719616, 0.027645697817206383, 0.03035333752632141, -0.014871192164719105, 0.010122408159077168, 0.027159711346030235, 0.013677053153514862, 0.002169583225622773, -0.021994367241859436, 0.016065331175923347, 0.0001552336907479912, -0.009317058138549328, -0.005043847486376762, 0.017689915373921394, -0.014093613252043724, 0.0006656281766481698, -0.004762669093906879, 0.005158401094377041, 0.030853210017085075, -0.0006534784915857017, 0.009553109295666218, -0.023313473910093307, 0.019314497709274292, -0.03215843066573143, 0.041989248245954514, 0.04126720875501633, 0.026909776031970978, -0.02471589297056198, -0.0016740504652261734, 0.00018517393618822098, 0.02117513306438923, 0.008379798382520676, -0.026632068678736687, -0.013607626780867577, -0.03404683619737625, -0.015801509842276573, 0.012253806926310062, -0.008039607666432858, -0.001044003525748849, 0.003752511227503419, -0.019758829846978188, 0.01418386772274971, -0.026215508580207825, 0.008483938872814178, -0.03263053297996521, 0.004478020127862692, 0.007824385538697243, -0.0041343579068779945, -0.016773482784628868, -0.005554133094847202, 0.009768332354724407, 0.01273979339748621, -0.04215587303042412, 0.008907441049814224, -0.014156097546219826, 0.012628710828721523, 0.0024212549906224012, -0.010740305297076702, 0.0076577612198889256, -0.006810755934566259, -0.0346577912569046, 0.007602219935506582, -0.017078960314393044, 0.004800853785127401, -0.020536407828330994, 0.04243357852101326, -0.021036280319094658, 0.002197353867813945, 0.014787879772484303, 0.007130118552595377, -0.0047973827458918095, 0.021994367241859436, -0.006578176748007536, -0.031103147193789482, 0.008567250333726406, 0.005668687168508768, -0.0357130765914917, -0.0021799972746521235, -0.00011064874706789851, -0.013454888015985489, -0.03712937980890274, -0.011698393151164055, 0.03526874631643295, -0.031130917370319366, -0.0013902690261602402, 0.03585192933678627, -0.047626692801713943, -0.009580879472196102, -0.007171774748712778, -0.17917634546756744, 0.01828698441386223, 0.0712595283985138, -0.01010852213948965, 0.029103659093379974, 0.004207255784422159, -0.01605144515633583, -0.006626775488257408, -0.013399346731603146, -0.004637701436877251, 0.028159456327557564, -0.015857050195336342, -0.005283369217067957, -0.0013130317674949765, -0.008213174529373646, -0.010802789591252804, -0.015593228861689568, 0.011441514827311039, 0.039850905537605286, 0.01644023507833481, 0.014274122193455696, -0.0001964557741302997, -0.0173288956284523, -0.008719989098608494, -0.0013069569831714034, 0.007289799861609936, -0.009247631765902042, 0.02149449661374092, 0.019217301160097122, -0.0077410731464624405, -0.00716483173891902, -0.012469029054045677, 0.03593524172902107, -0.012892532162368298, 0.0011212406679987907, -0.03049219213426113, -0.0015681748045608401, 0.003554645227268338, -0.022244304418563843, 0.008067378774285316, 0.015565458685159683, 0.019814370200037956, -0.0034938969183713198, -0.0032179260160773993, 0.010795846581459045, 0.0305477324873209, 0.024896401911973953, -0.023230161517858505, 0.008990753442049026, -0.006838526576757431, -0.006029705982655287, -0.02785397879779339, 0.008053493686020374, -0.006939195096492767, 0.005418751388788223, 0.014412975870072842, -0.006470565218478441, 0.017134500667452812, 0.007220373023301363, 0.009136549197137356, -0.014801764860749245, -0.0014935411745682359, 0.017981506884098053, 0.0036969699431210756, -0.009539224207401276, -0.0287981815636158, -0.027923405170440674, 0.022313730791211128, 0.0009520131279714406, 0.0015733818290755153, -0.0036969699431210756, -0.05742973834276199, 0.016093101352453232, -0.025299077853560448, 0.021202903240919113, 0.0028742640279233456, 0.011024954728782177, 0.018856283277273178, 0.004196841735392809, -0.00013342937745619565, -0.008782473392784595, 0.026882005855441093, -0.020022651180624962, -0.016176413744688034, -0.0004441137134563178, 0.017967620864510536, -0.003901778720319271, -0.0014197753043845296, -0.012948073446750641, 0.001328652841039002, 0.022313730791211128, -0.03002008982002735, -0.030603274703025818, -0.012052468955516815, 0.006383781787008047, 0.02206379361450672, 0.011136037297546864, 0.0020723859779536724, -0.010788903571665287, -0.009275402873754501, -0.0059394510462880135, -0.009358714334666729, -0.018314754590392113, 0.022522009909152985, 0.009282344952225685, 0.01984214037656784, -0.00010403151827631518, 0.04062848538160324, 0.023813346400856972, 0.008796358481049538, -0.003731683362275362, 0.00184674933552742, 0.02406328171491623, 0.009115721099078655, 0.010289032012224197, 0.009511453099548817, -0.03560199588537216, -0.01605144515633583, 0.0022233889903873205, -0.005654802080243826, -0.04185039550065994, 0.02865932695567608, -0.004346109461039305, 0.023007996380329132, -0.009226803667843342, -0.028103914111852646, -0.04782108590006828, -0.017551060765981674, 0.037823647260665894, 0.03002008982002735, -0.015301637351512909, 0.025701751932501793, 0.006921838503330946, 0.006033177487552166, -0.025396274402737617, 0.016551317647099495, -0.02846493385732174, -0.04426644369959831, -0.007546678651124239, 0.004693242721259594, 0.02335513010621071, 0.011427628807723522, 0.002839550608769059, 0.0003054773260373622, -0.013795078732073307, 0.017315009608864784, 0.01257316954433918, -0.02111959084868431, 0.006196329835802317, -0.009365657344460487, 0.007345341145992279, -0.003957320004701614, -0.02263309247791767, 0.009455911815166473, 0.007525850553065538, -0.0012922037858515978, 0.012698137201368809, -0.005231299437582493, -0.025882260873913765, -0.0043877651914954185, 0.015232210047543049, -0.02316073514521122, -0.017315009608864784, -0.015079472213983536, 0.015246096067130566, -0.004578688647598028, 0.005200057290494442, 0.00340364221483469, 0.017703799530863762, -0.02789563499391079, -0.011351259425282478, -0.010837502777576447, -0.015759853646159172, 0.025923917070031166, 0.0031172572635114193, -0.009407313540577888, -0.0009459383436478674, -0.006599004380404949, 0.0006317826337181032, 0.002221653237938881, 0.018342524766921997, -0.022147106006741524, 0.01544049009680748, 0.008532537147402763, -0.0003638391208369285, 0.0212723296135664, 0.005592317786067724, 0.013461830094456673, -0.004703656770288944, 0.028062257915735245, 0.01766214333474636, 0.0042975107207894325, -0.0005723360809497535, -0.011142980307340622, 0.00982387363910675, -0.03349142521619797, 0.008935212157666683, 0.019286727532744408, 0.007317570503801107, 0.015926476567983627, -0.015662655234336853, -0.022702518850564957, -0.016023674979805946, 0.0074425386264920235, 0.004366937093436718, -0.0196477472782135, -0.018453607335686684, -0.030936522409319878, 0.022855257615447044, -0.013288264162838459, 0.008907441049814224, 0.04301676154136658, 0.0005523759173229337, -0.019536664709448814, 0.011906673200428486, -0.016398578882217407, 0.010816674679517746, -0.008025722578167915, 0.014288008213043213, -0.023549525067210197, -0.0001473147131036967, 0.004609930794686079, 0.017634373158216476, 0.017439978197216988, -0.030575504526495934, 0.017176156863570213, -0.024077167734503746, -0.00516187259927392, -0.0852559432387352, 0.011302661150693893, 0.020328128710389137, -0.009171262383460999, 0.017009533941745758, 0.009219861589372158, 0.023382900282740593, -0.00664066057652235, -0.028159456327557564, 0.010011325590312481, -0.05459713190793991, 0.00570687185972929, -0.01049036905169487, -0.023382900282740593, -0.0247714351862669, -0.030853210017085075, -0.02159169316291809, 0.005949865095317364, 0.0001252934307558462, 0.012996671721339226, 0.004311395809054375, -0.00831037200987339, -0.006106075365096331, 0.006161616649478674, -0.046015992760658264, 0.0025097739417105913, -0.01494061853736639, 0.015759853646159172, -0.004655058030039072, 0.0030981649179011583, 0.010899986140429974, -0.022327614948153496, -0.013204951770603657, 0.016065331175923347, -0.020564178004860878, -0.051875606179237366, 0.004682828672230244, 0.00755362119525671, 0.0067274440079927444, 0.016745712608098984, -0.019592205062508583, -0.016454119235277176, -0.012073297053575516, -0.005554133094847202, -0.007015564478933811, 0.0012002134462818503, -0.01162896677851677, 0.02807614393532276, 0.03435231372714043, -0.011740049347281456, 0.008838014677166939, 0.008685275912284851, 0.013961702585220337, -0.01937003992497921, -0.0031276713125407696, -0.015801509842276573, -0.01766214333474636, 0.016704056411981583, -0.0002505868615116924, 0.006199801340699196, 0.023952199146151543, -0.012462086975574493, -0.006574705243110657, -0.005154930055141449, 0.00826177280396223, -0.009525338187813759, -0.00890049897134304, 0.018300868570804596, 0.00826177280396223, 0.0036275433376431465, -0.013302149251103401, -0.019203415140509605, -0.002567050978541374, 0.010886101052165031, -0.01235794648528099, 0.006192858796566725, 0.027215253561735153, 0.0017608337802812457, -0.02420213632285595, 0.024257676675915718, 0.024285446852445602, 0.0010518139461055398, -0.021702775731682777, 0.011615080758929253, 0.01364233996719122, -0.017787111923098564, -0.02259143628180027, 0.004078816622495651, -0.022605322301387787, 0.015204439871013165, -0.007275914773344994, 0.024257676675915718, 0.003474804572761059, -0.002353563904762268, -0.002358770929276943, 0.013100812211632729, 0.0009025466279126704, -0.0032804100774228573, 0.02927028201520443, -0.0013425381621345878, 0.0031727985478937626, -0.0014466781867668033, -0.0005480367690324783, -0.03765702247619629, -0.02813168428838253, 0.010143236257135868, -0.03310263529419899, -0.03874007984995842, -0.023424556478857994, 0.007699417416006327, -0.027006972581148148, 0.027826208621263504, 0.029298052191734314, 0.02638213336467743, -0.009240689687430859, 0.018911823630332947, -0.021536150947213173, -0.00994189828634262, -0.03276938572525978, 0.011483170092105865, 0.015468261204659939, -0.002568786730989814, 0.007560563739389181, 0.006047062575817108, 0.027687354013323784, -0.0015161047922447324, 8.793592314759735e-06, -0.010650050826370716, -0.006484450772404671, 0.006800341885536909, -0.00537362415343523, -0.013920046389102936, -0.014426860958337784, -0.023716149851679802, -0.022230418398976326, -0.0038323518820106983, -0.006717029958963394, 0.024660352617502213, -0.002839550608769059, 0.034407854080200195, 0.003790695918723941, -0.00902546662837267, 0.01364233996719122, 0.002600028645247221, 0.015982018783688545, -0.013059156015515327, -0.016079215332865715, 0.009539224207401276, -0.020425325259566307, 0.020161503925919533, -0.00992107018828392, -0.005571490153670311, 0.000300704239634797, -0.008178461343050003, -0.006460151169449091, -0.011524826288223267, 0.027812322601675987, 0.007588334381580353, 0.010351516306400299, 0.011004126630723476, 0.004613401833921671, 0.00978221744298935, 0.019619975239038467, -0.030769897624850273, -0.010615337640047073, -0.002650362905114889, -0.002561843954026699, -0.005679101217538118, 0.0012600939953699708, 0.00040766471647657454, 0.02709028497338295, -0.007421710528433323, -0.028395505622029305, 0.01219132263213396, 0.01231629028916359, -0.005661744624376297, -0.01217049453407526, 0.01685679517686367, 0.0009650306310504675, 0.016967877745628357, 0.025493470951914787, -0.022327614948153496, -0.029159199446439743, -0.00266945525072515, 0.0065191639587283134, -0.007893811911344528, -0.0106778210029006, -0.014551829546689987]

        result = self.pinecone_index.query(
            filter={
                "file_id": {"$eq": file_id}
            },
            vector=term_embedding,
            top_k=5,
            include_values=False,
            namespace=self.settings.embedding_namespace,
            include_metadata=True,
        )

        match_texts = []

        for text in result.matches:
            metadata = text.metadata
            match_texts.append({
                "score": text.score,
                "text": metadata.get("text"),
            })

        return match_texts
